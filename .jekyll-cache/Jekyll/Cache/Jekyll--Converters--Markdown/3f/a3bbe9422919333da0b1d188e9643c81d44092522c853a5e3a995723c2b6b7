I"Ã<h1 id="æ¥å£ç”¨ä¾‹ç¼–å†™">æ¥å£ç”¨ä¾‹ç¼–å†™</h1>
<p>å®é™…æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ¨¡å—çš„æµ‹è¯•ç”¨ä¾‹å†™çš„è¶Šè¯¦ç»†è¶Šå¥½ï¼Œè¦æ ¹æ®æ¥å£æ–‡æ¡£è¿›è¡Œç¼–å†™ã€‚
| ç”¨ä¾‹ID    | æ¨¡å—     | æ¥å£åœ°å€                                            | è¯·æ±‚æ–¹å¼ | è¯·æ±‚å‚æ•°                                                   | é¢„æœŸç»“æœ  | å¤‡æ³¨ |
|:â€”|:â€”|:â€”|:â€”-|:â€”â€“|:â€“| :â€”|
| login_1 | ç™»å½•     | http://211/103.136.242:8064/authorizations/     | POST | 1  | æ— æ•ˆæ•°æç¤º | 1 | 
| cate_1  | å•†å“åˆ—è¡¨æ•°æ® | http://211/103.136.242:8064/categories/115/skus | GET  | {â€œpageâ€:â€1â€,â€page_sizeâ€:â€10â€,â€orderingâ€:â€create_timeâ€} |  | 1|
| cart_1  | è´­ç‰©è½¦   | http://211/103.136.242:8064/cart/               | POST | {â€œsku_idâ€:â€3â€,â€countâ€:1,â€selectedâ€:â€trueâ€}  | æ·»åŠ æˆåŠŸ  | 1|
| order_1 | è®¢å•     | http://211/103.136.242:8064/orders/             | POST | {â€œaddressâ€:â€1â€,â€pay_methodâ€:â€1â€  }  | åˆ›å»ºæˆåŠŸ  | 1|</p>

<h1 id="å®‰è£…é¡¹ç›®ä¾èµ–">å®‰è£…é¡¹ç›®ä¾èµ–</h1>
<p>ä¸‹è½½requirements.txtä¸­æ‰€éœ€çš„package:</p>
<pre><code class="language-commandline">pip install -r requirements.txt
</code></pre>
<p>åˆ—å‡ºå·²ç»å®‰è£…çš„åŒ…è£¹</p>
<pre><code class="language-commandline">pip list
</code></pre>

<p>pip installä¸´æ—¶æ·»åŠ é•œåƒæºï¼š</p>
<pre><code class="language-commandline">pip install pytest -i https://pypi.tuna.tsinghua.edu.cn/simple 
</code></pre>
<p>å›½å†…é•œåƒæºåŒ…æ‹¬ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">é•œåƒæº</th>
      <th style="text-align: left">åœ°å€</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">æ¸…å</td>
      <td style="text-align: left">https://pypi.tuna.tsinghua.edu.cn/simple</td>
    </tr>
    <tr>
      <td style="text-align: left">é˜¿é‡Œ</td>
      <td style="text-align: left">http://mirrors.aliyun.com/pypi/simple/</td>
    </tr>
    <tr>
      <td style="text-align: left">è±†ç“£</td>
      <td style="text-align: left">http://pypi.douban.com/simple/</td>
    </tr>
    <tr>
      <td style="text-align: left">ç™¾åº¦</td>
      <td style="text-align: left">https://mirror.baidu.com/pypi/simple</td>
    </tr>
  </tbody>
</table>

<h1 id="requests">Requests</h1>
<p>Requestsæ˜¯ä¸€ä¸ªPython HTTPåº“ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚ã€‚å®ƒæ¯”urllibæ›´åŠ æ–¹ä¾¿ï¼Œä½†æ˜¯å®ƒä¸æ”¯æŒéªŒè¯ã€cookiesæˆ–è€…å…¶å®ƒå¤æ‚çš„HTTPå®¢æˆ·ç«¯åŠŸèƒ½ã€‚Requestsæ˜¯ä¸€ä¸ªApache2 Licensedå¼€æºé¡¹ç›®ï¼Œç”±Kenneth Reitzåˆ›å»ºå’Œç»´æŠ¤ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<pre><code class="language-commandline">pip install requests
</code></pre>
<h2 id="ä½¿ç”¨">ä½¿ç”¨</h2>
<pre><code class="language-python">import requests
r = requests.get('https://api.github.com/events')
print(r.text)
</code></pre>
<h2 id="è¯·æ±‚è¿”å›ä»‹ç»">è¯·æ±‚è¿”å›ä»‹ç»</h2>
<pre><code>r.status_code #å“åº”çŠ¶æ€
r.content #å­—èŠ‚æ–¹å¼çš„å“åº”ä½“ï¼Œä¼šè‡ªåŠ¨ä¸ºä½ è§£ç  gzip å’Œ deflate å‹ç¼©
r.headers #ä»¥å­—å…¸å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨å“åº”å¤´ï¼Œè‹¥é”®ä¸å­˜åœ¨åˆ™è¿”å›None
r.json() #Requestsä¸­å†…ç½®çš„JSON
r.url # è·å–url
r.encoding # ç¼–ç æ ¼å¼
r.cookies # è·å–cookie
r.raw #è¿”å›åŸå§‹å“åº”ä½“
r.text #å­—ç¬¦ä¸²æ–¹å¼çš„å“åº”ä½“ï¼Œä¼šè‡ªåŠ¨æ ¹æ®å“åº”å¤´éƒ¨çš„å­—ç¬¦ç¼–ç è¿›è¡Œ
r.raise_for_status() #å¤±è´¥è¯·æ±‚(é200å“åº”)æŠ›å‡ºå¼‚å¸¸
</code></pre>
<h2 id="requestsç”¨ä¾‹ç¼–å†™">Requestsç”¨ä¾‹ç¼–å†™</h2>

<h3 id="ç¼–å†™ç™»å½•è„šæœ¬">ç¼–å†™ç™»å½•è„šæœ¬</h3>
<pre><code class="language-python">import requests
def login():
    url = "http://172.17.0.139:5004/authorizations/"
    data = {"username":"python",
    "password":"12345678"}
    r= requests.post(url,json=data)
    print(r.text)
</code></pre>
<h3 id="ç¼–å†™ä¸ªäººä¿¡æ¯è·å–è„šæœ¬">ç¼–å†™ä¸ªäººä¿¡æ¯è·å–è„šæœ¬</h3>

<pre><code class="language-python">import requests
def info():
    url = "http://172.17.0.139:5004/user/"
    token = "***"
    headers = {
                "Authorization": "JWT"+token
            }
    r = requests.get(url,headers=headers)
    print(r.text)
</code></pre>

<h3 id="ç¼–å†™å•†å“åˆ—è¡¨è„šæœ¬">ç¼–å†™å•†å“åˆ—è¡¨è„šæœ¬</h3>
<pre><code class="language-python">import requests
def goods_list():
    url = "http://172.17.0.139:5004/categories/115/skus"
    data = {
            # "categroy_id":"115",
            "page":"1",
            "page_size": "10",
            "ordering": "create_time",#'create_time', 'price', 'sales'
            }
    r = requests.get(url, json=data)
    print(r.text)
    print(r.json)
</code></pre>
<h3 id="æ·»åŠ åˆ°è´­ç‰©è½¦">æ·»åŠ åˆ°è´­ç‰©è½¦</h3>
<pre><code class="language-python">import requests
def cart():
    url = "http://172.17.0.139:5004/cart/"
    data = {
            "sku_id": "3",
            "count": "1",
            "selected": "true",
            }
    token = "***"
    headers = {
                "Authorization": "JWT"+token
            }
    r = requests.post(url, json=data,headers=headers)
    print(r.text)
</code></pre>
<h3 id="ä¿å­˜è®¢å•">ä¿å­˜è®¢å•</h3>
<pre><code class="language-python">import requests
def order():
    url = "http://172.17.0.139:5004/cart/"
    token = "***"
    headers = {
                "Authorization": "JWT"+token
                }
    r = requests.get(url,headers=headers)
    print(r.text)
</code></pre>

<h2 id="requestsçš„å°è£…">Requestsçš„å°è£…</h2>
<h3 id="å°è£…requests_getæ–¹æ³•">å°è£…requests_getæ–¹æ³•</h3>
<pre><code class="language-python">#1ã€åˆ›å»ºå°è£…getæ–¹æ³•
def requests_get(url,headers):
    #2ã€å‘é€requests getè¯·æ±‚
    r = requests.get(url,headers = headers)
    #3ã€è·å–ç»“æœç›¸åº”å†…å®¹
    code = r.status_code
    try:
    body = r.json()
    except Exception as e:
    body = r.text
    #4ã€å†…å®¹å­˜åˆ°å­—å…¸
    res = dict()
    res["code"] = code
    res["body"] = body
    #5ã€å­—å…¸è¿”å›
    return res
</code></pre>
<h3 id="requests_postæ–¹æ³•å°è£…">requests_postæ–¹æ³•å°è£…</h3>
<pre><code class="language-python">#1ã€åˆ›å»ºpostæ–¹æ³•
def requests_post(url,json=None,headers=None):
    #2ã€å‘é€postè¯·æ±‚
    r= requests.post(url,json=json,headers=headers)
    #3ã€è·å–ç»“æœå†…å®¹
    code = r.status_code
    try:
        body = r.json()
    except Exception as e:
        body = r.text
    #4ã€å†…å®¹å­˜åˆ°å­—å…¸
    res = dict()
    res["code"] = code
    res["body"] = body
    #5ã€å­—å…¸è¿”å›
    return res
</code></pre>

<p>å¯ä»¥å‘ç°,requests_getå’Œrequests_postæ–¹æ³•çš„åŒºåˆ«å°±æ˜¯è¯·æ±‚æ–¹å¼ä¸åŒ,å…¶ä»–éƒ½æ˜¯ä¸€æ ·çš„,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ–¹æ³•åˆå¹¶æˆä¸€ä¸ªæ–¹æ³•,è¿™æ ·å°±å¯ä»¥å‡å°‘ä»£ç é‡,æé«˜ä»£ç çš„å¤ç”¨æ€§.</p>
<pre><code class="language-python"># é‡æ„
# 1ã€åˆ›å»ºç±»
class Requests:
# 2ã€å®šä¹‰å…¬å…±æ–¹æ³•
# 2.1 å¢åŠ æ–¹æ³•çš„å‚æ•°ï¼Œæ ¹æ®å‚æ•°æ¥éªŒè¯è¯·æ±‚æ–¹å¼æ˜¯getè¿˜æ˜¯post
# 2.2 é‡å¤çš„å†…å®¹ï¼Œå¤åˆ¶è¿›æ¥å³å¯
# åç»­å‚æ•°è¿˜å¯ä»¥åŠ å…¥dataã€cookiesç­‰
  def requests_api(self,url,json=None,headers=None,method="get"):
    # 3ã€åˆ¤æ–­è¯·æ±‚æ–¹å¼
    if method == "get":
      r = requests.get(url,headers=headers)
    elif method == "post":
      r = requests.post(url,json=json,headers=headers)
    # 4ã€è·å–ç»“æœå†…å®¹
    code = r.status_code
    try:
      body = r.json()
    except Exception as e:
      body = r.text
    # 5ã€å†…å®¹å­˜åˆ°å­—å…¸
    res = dict()
    res["code"] = code
    res["body"] = body
    # 6ã€å­—å…¸è¿”å›
    return res
### é‡æ„get/postæ–¹æ³•
  def get(self,**kwargs):
    # è°ƒç”¨å…¬å…±æ–¹æ³•
    return self.requests_api(url,method="get",**kwargs)
  def post(self,**kwargs):
    # è°ƒç”¨å…¬å…±æ–¹æ³•
    return self.requests_api(url,method="post",**kwargs)
</code></pre>

:ET
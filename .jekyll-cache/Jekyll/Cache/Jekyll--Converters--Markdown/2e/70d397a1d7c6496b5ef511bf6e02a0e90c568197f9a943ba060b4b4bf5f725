I"ı<p>ä¸»è¦åŒ…æ‹¬ä½¿ç”¨ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œ(1D CNN)å¯¹å®‰è£…åœ¨è¿œç¨‹é£æœºçš„é«˜é€Ÿè½´æ‰¿ä¸­çš„ç°åœºä¼ æ„Ÿå™¨é‡‡é›†åˆ°çš„æ—¶é—´åºåˆ—æ•°æ®é€šè¿‡çŸ­æ—¶å‚…é‡Œå¶å˜åŒ–ä¹‹åå¾—åˆ°çš„é¢‘è°±å³°åº¦ï¼ˆKurtosis Spectogramï¼‰è¿›è¡Œåˆ†ç±»ï¼Œå¾—åˆ°æ¯ä¸ªæ ·å“çš„ç±»åˆ«ï¼šä¸­ç­‰å¯¿å‘½çº§ï¼ˆé¢„æœŸå¯¿å‘½å¤§äº15å¤©çš„è½´æ‰¿â€”â€”çŠ¶æ€è‰¯å¥½ï¼‰ä»¥åŠçŸ­å¯¿å‘½è½´æ‰¿ï¼ˆé¢„æœŸå¯¿å‘½å°äº15å¤©çš„è½´æ‰¿â€”â€”çŠ¶æ€ä¸è‰¯ï¼‰ã€‚</p>

<p><a href="https://www.kaggle.com/code/luishpinto/wind-turbine-high-speed-bearing-prognosis">åŸæ–‡é“¾æ¥ï¼šWind Turbine High Speed Bearing Prognosis Kaggle</a></p>

<h1 id="1-é—®é¢˜æè¿°">1. é—®é¢˜æè¿°</h1>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220141757.png" alt="è½´æ‰¿å¯¿å‘½é¢„æµ‹" /></p>

<p>æœ¬æ–‡å±•ç¤ºäº†ä½¿ç”¨æŒ¯åŠ¨ç›‘æµ‹ä¼ æ„Ÿå™¨çš„åŸå§‹æ•°æ®æ¥é¢„æµ‹è½´æ‰¿çš„RULï¼ˆå‰©ä½™ä½¿ç”¨å¯¿å‘½ï¼‰çš„æ–°æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºå…¶ä»–ç±»å‹çš„æœºå™¨å…ƒä»¶ï¼Œå¦‚é½¿è½®ã€è”è½´å™¨ç­‰å‰©ä½™å¯¿å‘½çš„é¢„æµ‹ã€‚</p>

<p>æœ¬ä¾‹ä¸­ä½¿ç”¨çš„æ•°æ®æ˜¯ç”±å®‰è£…åœ¨ä¸€ä¸ªè¿œç¨‹é£åŠ›æ¶¡è½®æœºçš„é«˜é€Ÿè½´æ‰¿ä¸Šçš„ç°åœºä¼ æ„Ÿå™¨è®°å½•çš„ã€‚
è¯¥è½´æ‰¿æ˜¯é½¿è½®ç®±çš„ä¸€éƒ¨åˆ†ï¼Œè´Ÿè´£è½¬å­å’Œå‘ç”µæœºä¹‹é—´çš„è€¦åˆï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜é€Ÿè½´ä¸Šï¼ˆå‘ç”µæœºä¸€ä¾§ï¼‰ã€‚</p>

<p>è¯¥æ•°æ®å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š</p>

<ol>
  <li><a href="https://github.com/mathworks/WindTurbineHighSpeedBearingPrognosis-Data">WindTurbineHighSpeedBearingPrognosis-Data</a></li>
</ol>

<p>è®°å½•çš„å˜é‡æ˜¯ä¼ æ„Ÿå™¨åœ¨30å¤©å†…æµ‹å¾—çš„åŠ é€Ÿåº¦ï¼ˆå•ä½ï¼šgï¼‰ï¼Œæ¯å¤©6ç§’ã€‚</p>

<h1 id="2-æŠ€æœ¯èƒŒæ™¯">2. æŠ€æœ¯èƒŒæ™¯</h1>

<p>è¯¥æ–¹æ³•æ˜¯åŸºäºå¯¹50ä¸ªæ ·æœ¬ä¸­çš„æ¯ä¸ªæ ·æœ¬çš„Kurtosis Spectogramï¼ˆé¢‘è°±å³°åº¦ï¼‰çš„è®¡ç®—ï¼Œå¹¶ä½¿ç”¨1D-CNNâ€“ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œå°†æ¯ä¸ªæ ·æœ¬åˆ’åˆ†ä¸ºä¸¤ä¸ªRULç­‰çº§ã€‚ä¸­ç­‰é¢„æœŸå¯¿å‘½ç±»ï¼Œä»£è¡¨è½´æ‰¿çš„é¢„æœŸå¯¿å‘½å¤§äº15å¤©ï¼ˆçŠ¶å†µè‰¯å¥½ï¼‰ã€‚</p>

<ol>
  <li>ä¸­ç­‰é¢„æœŸå¯¿å‘½çš„ç±»åˆ«ï¼šå¯¿å‘½å¤§äº15å¤©ï¼ˆçŠ¶å†µè‰¯å¥½ï¼‰ã€‚</li>
  <li>çŸ­é¢„æœŸå¯¿å‘½ç±»åˆ«ï¼Œä»£è¡¨è½´æ‰¿çš„å¯¿å‘½æœŸæœ›å€¼å°äº15å¤©ï¼ˆçŠ¶å†µä¸ä½³ï¼‰ã€‚</li>
</ol>

<p>åŸºäºè¿™ä¸ªå‡è®¾ï¼Œå¯¿å‘½æœ€çŸ­çš„15ä¸ªè¢«æ ‡è®°ä¸ºçŸ­å¯¿å‘½ç±»ï¼Œè€Œæ‰€æœ‰å‰©ä½™çš„è¢«æ ‡è®°ä¸ºä¸­å¯¿å‘½ç±»ã€‚</p>

<h1 id="æ•°æ®å¤„ç†æµç¨‹">æ•°æ®å¤„ç†æµç¨‹</h1>

<h2 id="å¯¼å…¥åŒ…">å¯¼å…¥åŒ…</h2>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

import matplotlib
matplotlib.rcParams['mathtext.fontset'] = 'stix' 
matplotlib.rcParams['font.family'] = 'sans-serif'
matplotlib.rcParams['font.size'] = 10

from scipy.io import loadmat # scipyåŠ è½½matæ–‡ä»¶
from scipy.signal import stft # scipyçš„çŸ­æ—¶å‚…é‡Œå¶å˜æ¢
from scipy.stats import kurtosis # kurtosisè¡¨ç¤ºå³°åº¦ï¼Œå³°åº¦æ˜¯ç»Ÿè®¡å­¦ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œç”¨æ¥æè¿°æŸä¸ªåˆ†å¸ƒçš„å³°å€¼çš„é™¡å³­ç¨‹åº¦

from mpl_toolkits.mplot3d import Axes3D

from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
from sklearn.model_selection import train_test_split

from tensorflow.keras.models import *
from tensorflow.keras.layers import *
from tensorflow.keras.utils import *
</code></pre>

<h2 id="å®šä¹‰æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°">å®šä¹‰æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°</h2>

<pre><code class="language-python">def plotConfusionMatrix(dtrue,dpred,classes,\
                        cmap = plt.cm.Blues,bsize = 1.0): # æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°,dtrueè¡¨ç¤ºçœŸå®å€¼,dpredè¡¨ç¤ºé¢„æµ‹å€¼,classesè¡¨ç¤ºç±»åˆ«,cmapè¡¨ç¤ºé¢œè‰²,bsizeè¡¨ç¤ºå›¾åƒå¤§å°
  
    cm = confusion_matrix(dtrue,dpred,normalize = 'true') # æ··æ·†çŸ©é˜µ,normalize = 'true'è¡¨ç¤ºå½’ä¸€åŒ–
  
    fig,ax = plt.subplots(figsize = (np.shape(classes)[0] * 1.25 * bsize,\
                                     np.shape(classes)[0] * 1.25 * bsize))
  
    im = ax.imshow(cm,interpolation = 'nearest',cmap = cmap) # interpolation = 'nearest'è¡¨ç¤ºæ’å€¼æ–¹å¼,nearestè¡¨ç¤ºæœ€è¿‘é‚»æ’å€¼,cmè¡¨ç¤ºæ··æ·†çŸ©é˜µ,cmapè¡¨ç¤ºé¢œè‰²
  
    ax.set(xticks = np.arange(cm.shape[1]),\
           yticks = np.arange(cm.shape[0]),\
           xticklabels = classes,\
           yticklabels = classes,\
           ylabel = 'True Efficiency',\
           xlabel = 'Predicted Efficiency')
  
    plt.setp(ax.get_xticklabels(),rotation = 90,ha = 'right',\
             rotation_mode = 'anchor') # haè¡¨ç¤ºæ°´å¹³å¯¹é½æ–¹å¼,rotation_modeè¡¨ç¤ºæ—‹è½¬æ¨¡å¼ï¼Œanchorè¡¨ç¤ºé”šç‚¹;setpè¡¨ç¤ºè®¾ç½®å±æ€§

    fmt = '.2f' # ä¿ç•™ä¸¤ä½å°æ•°

    thresh = cm.max() / 2.0 
  
    for i in range(cm.shape[0]):
        for j in range(cm.shape[1]):
            ax.text(j,i,format(cm[i,j],fmt),ha = 'center',va = 'center',\
                    color = 'white' if cm[i,j] &gt; thresh else 'black') # haè¡¨ç¤ºæ°´å¹³å¯¹é½æ–¹å¼,vaè¡¨ç¤ºå‚ç›´å¯¹é½æ–¹å¼,jè¡¨ç¤ºåˆ—,iè¡¨ç¤ºè¡Œ
  
    fig.tight_layout()
  
    return ax
</code></pre>

<h2 id="æ•°æ®ç»´åº¦">æ•°æ®ç»´åº¦</h2>

<p>æ‰«æé¢‘ç‡ä¸º97656HZï¼Œé‡‡æ ·çš„æ€»å…±æ—¶é•¿ä¸º6sï¼Œæ‰€ä»¥é‡‡æ ·ç‚¹çš„ä¸ªæ•°ä¸º</p>

<pre><code class="language-python">fname = !ls './input/data'
fname = np.asarray(fname)

df = []

for i in fname:
    df.append(loadmat('./input/data/' + i)['vibration'].flatten())# loadmatè¡¨ç¤ºåŠ è½½matæ–‡ä»¶,flattenè¡¨ç¤ºé™ç»´
    
df = np.asarray(df) # è½¬æ¢ä¸ºæ•°ç»„

df.shape[0]

</code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>

<pre><code class="language-console">50 # è¡¨ç¤ºæ ·æœ¬æ•°é‡
</code></pre>

<p>æŸ¥çœ‹é‡‡æ ·é¢‘ç‡</p>

<pre><code class="language-python">fs = int(df.shape[1] / 6.0) # é‡‡æ ·é¢‘ç‡
t = np.linspace(0.0,6.0,df.shape[1]) # df.shape[1]è¡¨ç¤ºdfçš„ç¬¬äºŒç»´åº¦çš„é•¿åº¦,å³é‡‡æ ·ç‚¹æ•°ï¼›tè¡¨ç¤ºä¸€ä¸ªå‘¨æœŸå†…ï¼Œæ¯ä¸ªé‡‡æ ·ç‚¹çš„æ—¶é—´;

print('Scan frequency: {:,d} Hz'.format(fs)) # {:,d}è¡¨ç¤ºä»¥é€—å·åˆ†éš”çš„åè¿›åˆ¶æ•´æ•°,scan frequencyè¡¨ç¤ºæ‰«æé¢‘ç‡
</code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<pre><code class="language-console">Scan frequency: 97,656 Hz
</code></pre>

<p>ä¸‹å›¾æ˜¾ç¤ºäº†åŠ é€Ÿåº¦çš„æµ‹é‡å€¼ï¼ˆå•ä½ï¼šgï¼‰ï¼Œæ­£å¦‚å¯ä»¥æ³¨æ„åˆ°çš„é‚£æ ·ï¼ŒåŠ é€Ÿåº¦çš„æŒ¯å¹…åœ¨æ—¶åŸŸä¸Šå˜åŒ–æ˜æ˜¾(xè½´è¡¨ç¤ºæ—¶é—´ï¼Œæ¯å¤©6ç§’ï¼Œ50å¤©)</p>

<pre><code class="language-python">plt.subplots(figsize = (12.0,6.0))
for i in range(df.shape[0]):
    plt.plot(t + i * 6.0,df[i],color = 'black',lw = 0.25) 

plt.xlabel('Time (in s): sample = 50 days in total, 6 seconds per day')
plt.ylabel('Acceleration (in g)')    
plt.show()
</code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220145445.png" alt="åŠ é€Ÿåº¦æŒ¯å¹…å›¾" /></p>
:ET
I"µ2<p>ä¸»è¦åŒ…æ‹¬ä½¿ç”¨ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œ(1D CNN)å¯¹å®‰è£…åœ¨è¿œç¨‹é£æœºçš„é«˜é€Ÿè½´æ‰¿ä¸­çš„ç°åœºä¼ æ„Ÿå™¨é‡‡é›†åˆ°çš„æ—¶é—´åºåˆ—æ•°æ®é€šè¿‡çŸ­æ—¶å‚…é‡Œå¶å˜åŒ–ä¹‹åå¾—åˆ°çš„é¢‘è°±å³°åº¦ï¼ˆKurtosis Spectogramï¼‰è¿›è¡Œåˆ†ç±»ï¼Œå¾—åˆ°æ¯ä¸ªæ ·å“çš„ç±»åˆ«ï¼šä¸­ç­‰å¯¿å‘½çº§ï¼ˆé¢„æœŸå¯¿å‘½å¤§äº15å¤©çš„è½´æ‰¿â€”â€”çŠ¶æ€è‰¯å¥½ï¼‰ä»¥åŠçŸ­å¯¿å‘½è½´æ‰¿ï¼ˆé¢„æœŸå¯¿å‘½å°äº15å¤©çš„è½´æ‰¿â€”â€”çŠ¶æ€ä¸è‰¯ï¼‰ã€‚</p>

<p><a href="https://www.kaggle.com/code/luishpinto/wind-turbine-high-speed-bearing-prognosis">åŸæ–‡é“¾æ¥ï¼šWind Turbine High Speed Bearing Prognosis Kaggle</a></p>

<h1 id="1-é—®é¢˜æè¿°">1. é—®é¢˜æè¿°</h1>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220141757.png" alt="è½´æ‰¿å¯¿å‘½é¢„æµ‹" /></p>

<p>æœ¬æ–‡å±•ç¤ºäº†ä½¿ç”¨æŒ¯åŠ¨ç›‘æµ‹ä¼ æ„Ÿå™¨çš„åŸå§‹æ•°æ®æ¥é¢„æµ‹è½´æ‰¿çš„RULï¼ˆå‰©ä½™ä½¿ç”¨å¯¿å‘½ï¼‰çš„æ–°æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºå…¶ä»–ç±»å‹çš„æœºå™¨å…ƒä»¶ï¼Œå¦‚é½¿è½®ã€è”è½´å™¨ç­‰å‰©ä½™å¯¿å‘½çš„é¢„æµ‹ã€‚</p>

<p>æœ¬ä¾‹ä¸­ä½¿ç”¨çš„æ•°æ®æ˜¯ç”±å®‰è£…åœ¨ä¸€ä¸ªè¿œç¨‹é£åŠ›æ¶¡è½®æœºçš„é«˜é€Ÿè½´æ‰¿ä¸Šçš„ç°åœºä¼ æ„Ÿå™¨è®°å½•çš„ã€‚
è¯¥è½´æ‰¿æ˜¯é½¿è½®ç®±çš„ä¸€éƒ¨åˆ†ï¼Œè´Ÿè´£è½¬å­å’Œå‘ç”µæœºä¹‹é—´çš„è€¦åˆï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜é€Ÿè½´ä¸Šï¼ˆå‘ç”µæœºä¸€ä¾§ï¼‰ã€‚</p>

<p>è¯¥æ•°æ®å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š</p>

<ol>
  <li><a href="https://github.com/mathworks/WindTurbineHighSpeedBearingPrognosis-Data">WindTurbineHighSpeedBearingPrognosis-Data</a></li>
</ol>

<p>è®°å½•çš„å˜é‡æ˜¯ä¼ æ„Ÿå™¨åœ¨30å¤©å†…æµ‹å¾—çš„åŠ é€Ÿåº¦ï¼ˆå•ä½ï¼šgï¼‰ï¼Œæ¯å¤©6ç§’ã€‚</p>

<h1 id="2-æŠ€æœ¯èƒŒæ™¯">2. æŠ€æœ¯èƒŒæ™¯</h1>

<p>è¯¥æ–¹æ³•æ˜¯åŸºäºå¯¹50ä¸ªæ ·æœ¬ä¸­çš„æ¯ä¸ªæ ·æœ¬çš„Kurtosis Spectogramï¼ˆé¢‘è°±å³°åº¦ï¼‰çš„è®¡ç®—ï¼Œå¹¶ä½¿ç”¨1D-CNNâ€“ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œå°†æ¯ä¸ªæ ·æœ¬åˆ’åˆ†ä¸ºä¸¤ä¸ªRULç­‰çº§ã€‚ä¸­ç­‰é¢„æœŸå¯¿å‘½ç±»ï¼Œä»£è¡¨è½´æ‰¿çš„é¢„æœŸå¯¿å‘½å¤§äº15å¤©ï¼ˆçŠ¶å†µè‰¯å¥½ï¼‰ã€‚</p>

<ol>
  <li>ä¸­ç­‰é¢„æœŸå¯¿å‘½çš„ç±»åˆ«ï¼šå¯¿å‘½å¤§äº15å¤©ï¼ˆçŠ¶å†µè‰¯å¥½ï¼‰ã€‚</li>
  <li>çŸ­é¢„æœŸå¯¿å‘½ç±»åˆ«ï¼Œä»£è¡¨è½´æ‰¿çš„å¯¿å‘½æœŸæœ›å€¼å°äº15å¤©ï¼ˆçŠ¶å†µä¸ä½³ï¼‰ã€‚</li>
</ol>

<p>åŸºäºè¿™ä¸ªå‡è®¾ï¼Œå¯¿å‘½æœ€çŸ­çš„15ä¸ªè¢«æ ‡è®°ä¸ºçŸ­å¯¿å‘½ç±»ï¼Œè€Œæ‰€æœ‰å‰©ä½™çš„è¢«æ ‡è®°ä¸ºä¸­å¯¿å‘½ç±»ã€‚</p>

<h1 id="æ•°æ®å¤„ç†æµç¨‹">æ•°æ®å¤„ç†æµç¨‹</h1>

<h2 id="å¯¼å…¥åŒ…">å¯¼å…¥åŒ…</h2>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

import matplotlib
matplotlib.rcParams['mathtext.fontset'] = 'stix' 
matplotlib.rcParams['font.family'] = 'sans-serif'
matplotlib.rcParams['font.size'] = 10

from scipy.io import loadmat # scipyåŠ è½½matæ–‡ä»¶
from scipy.signal import stft # scipyçš„çŸ­æ—¶å‚…é‡Œå¶å˜æ¢
from scipy.stats import kurtosis # kurtosisè¡¨ç¤ºå³°åº¦ï¼Œå³°åº¦æ˜¯ç»Ÿè®¡å­¦ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œç”¨æ¥æè¿°æŸä¸ªåˆ†å¸ƒçš„å³°å€¼çš„é™¡å³­ç¨‹åº¦

from mpl_toolkits.mplot3d import Axes3D

from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
from sklearn.model_selection import train_test_split

from tensorflow.keras.models import *
from tensorflow.keras.layers import *
from tensorflow.keras.utils import *
</code></pre>

<h2 id="å®šä¹‰æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°">å®šä¹‰æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°</h2>

<pre><code class="language-python">def plotConfusionMatrix(dtrue,dpred,classes,\
                        cmap = plt.cm.Blues,bsize = 1.0): # æ··æ·†çŸ©é˜µå¯è§†åŒ–å‡½æ•°,dtrueè¡¨ç¤ºçœŸå®å€¼,dpredè¡¨ç¤ºé¢„æµ‹å€¼,classesè¡¨ç¤ºç±»åˆ«,cmapè¡¨ç¤ºé¢œè‰²,bsizeè¡¨ç¤ºå›¾åƒå¤§å°
  
    cm = confusion_matrix(dtrue,dpred,normalize = 'true') # æ··æ·†çŸ©é˜µ,normalize = 'true'è¡¨ç¤ºå½’ä¸€åŒ–
  
    fig,ax = plt.subplots(figsize = (np.shape(classes)[0] * 1.25 * bsize,\
                                     np.shape(classes)[0] * 1.25 * bsize))
  
    im = ax.imshow(cm,interpolation = 'nearest',cmap = cmap) # interpolation = 'nearest'è¡¨ç¤ºæ’å€¼æ–¹å¼,nearestè¡¨ç¤ºæœ€è¿‘é‚»æ’å€¼,cmè¡¨ç¤ºæ··æ·†çŸ©é˜µ,cmapè¡¨ç¤ºé¢œè‰²
  
    ax.set(xticks = np.arange(cm.shape[1]),\
           yticks = np.arange(cm.shape[0]),\
           xticklabels = classes,\
           yticklabels = classes,\
           ylabel = 'True Efficiency',\
           xlabel = 'Predicted Efficiency')
  
    plt.setp(ax.get_xticklabels(),rotation = 90,ha = 'right',\
             rotation_mode = 'anchor') # haè¡¨ç¤ºæ°´å¹³å¯¹é½æ–¹å¼,rotation_modeè¡¨ç¤ºæ—‹è½¬æ¨¡å¼ï¼Œanchorè¡¨ç¤ºé”šç‚¹;setpè¡¨ç¤ºè®¾ç½®å±æ€§

    fmt = '.2f' # ä¿ç•™ä¸¤ä½å°æ•°

    thresh = cm.max() / 2.0 
  
    for i in range(cm.shape[0]):
        for j in range(cm.shape[1]):
            ax.text(j,i,format(cm[i,j],fmt),ha = 'center',va = 'center',\
                    color = 'white' if cm[i,j] &gt; thresh else 'black') # haè¡¨ç¤ºæ°´å¹³å¯¹é½æ–¹å¼,vaè¡¨ç¤ºå‚ç›´å¯¹é½æ–¹å¼,jè¡¨ç¤ºåˆ—,iè¡¨ç¤ºè¡Œ
  
    fig.tight_layout()
  
    return ax
</code></pre>

<h2 id="æŸ¥çœ‹æ•°æ®">æŸ¥çœ‹æ•°æ®</h2>

<p>æ‰«æé¢‘ç‡ä¸º97656HZï¼Œé‡‡æ ·çš„æ€»å…±æ—¶é•¿ä¸º6sï¼Œæ‰€ä»¥é‡‡æ ·ç‚¹çš„ä¸ªæ•°ä¸º</p>

<pre><code class="language-python">fname = !ls './input/data'
fname = np.asarray(fname)

df = []

for i in fname:
    df.append(loadmat('./input/data/' + i)['vibration'].flatten())# loadmatè¡¨ç¤ºåŠ è½½matæ–‡ä»¶,flattenè¡¨ç¤ºé™ç»´
    
df = np.asarray(df) # è½¬æ¢ä¸ºæ•°ç»„

df.shape[0]

</code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>

<pre><code class="language-console">50 # è¡¨ç¤ºæ ·æœ¬æ•°é‡
</code></pre>

<p>æŸ¥çœ‹é‡‡æ ·é¢‘ç‡</p>

<pre><code class="language-python">fs = int(df.shape[1] / 6.0) # é‡‡æ ·é¢‘ç‡
t = np.linspace(0.0,6.0,df.shape[1]) # df.shape[1]è¡¨ç¤ºdfçš„ç¬¬äºŒç»´åº¦çš„é•¿åº¦,å³é‡‡æ ·ç‚¹æ•°ï¼›tè¡¨ç¤ºä¸€ä¸ªå‘¨æœŸå†…ï¼Œæ¯ä¸ªé‡‡æ ·ç‚¹çš„æ—¶é—´;

print('Scan frequency: {:,d} Hz'.format(fs)) # {:,d}è¡¨ç¤ºä»¥é€—å·åˆ†éš”çš„åè¿›åˆ¶æ•´æ•°,scan frequencyè¡¨ç¤ºæ‰«æé¢‘ç‡
</code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<pre><code class="language-console">Scan frequency: 97,656 Hz
</code></pre>

<p>ä¸‹å›¾æ˜¾ç¤ºäº†åŠ é€Ÿåº¦çš„æµ‹é‡å€¼ï¼ˆå•ä½ï¼šgï¼‰ï¼Œæ­£å¦‚å¯ä»¥æ³¨æ„åˆ°çš„é‚£æ ·ï¼ŒåŠ é€Ÿåº¦çš„æŒ¯å¹…åœ¨æ—¶åŸŸä¸Šå˜åŒ–æ˜æ˜¾(xè½´è¡¨ç¤ºæ—¶é—´ï¼Œæ¯å¤©6ç§’ï¼Œ50å¤©)</p>

<pre><code class="language-python">plt.subplots(figsize = (12.0,6.0))
for i in range(df.shape[0]):
    plt.plot(t + i * 6.0,df[i],color = 'black',lw = 0.25) 

plt.xlabel('Time (in s): sample = 50 days in total, 6 seconds per day')
plt.ylabel('Acceleration (in g)')    
plt.show()
</code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220145445.png" alt="åŠ é€Ÿåº¦æŒ¯å¹…å›¾" /></p>

<p>å°½ç®¡åŠ é€Ÿåº¦æœ‰æ˜æ˜¾çš„å˜åŒ–ï¼Œè®°å½•çš„æ•°æ®æ•°é‡ï¼ˆ6 x 97,656 = 
æ¯å¤©585,936ä¸ªè®°å½•ï¼›æ€»å…±29,286,800ä¸ªï¼‰å¾ˆå¤§ï¼Œå†åŠ ä¸Š æµ‹é‡çš„éåŒæ­¥æ¡ä»¶ï¼Œä½¿å¾—ä½¿ç”¨ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œæ¥å¯¹è½´æ‰¿çŠ¶å†µè¿›è¡Œåˆ†ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚</p>

<p>è¿™ä¸ªé—®é¢˜éœ€è¦ä¸€ä¸ªä¸åŒçš„æ–¹æ³•æ¥å°†æ­£å¼¦æ³¢çš„æ—¶åŸŸå˜é‡è½¬åŒ–ä¸ºéå‘¨æœŸæ€§å˜é‡ï¼Œä»è€Œä½¿åŒºåˆ†RULç­‰çº§æˆä¸ºå¯èƒ½ã€‚</p>

<h2 id="kurtosis">Kurtosis</h2>

<p>è¿™ä¸ªæ–°çš„å˜é‡æ˜¯é€šè¿‡çŸ­æ—¶å‚…é‡Œå¶å˜æ¢è®¡ç®—çš„Kurtosisï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸‰ç»´å›¾ã€‚å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼ŒKurtosisæ˜¯éå¸¸ç¨³å®šçš„ï¼Œæ— è®ºé¢‘ç‡å¦‚ä½•å˜åŒ–(ä¾‹å¦‚å‰äº”ä¸ªæ ·æœ¬)ï¼Œä½†å½“å¼‚å¸¸çš„è¿è¡Œæ¡ä»¶å¯¼è‡´æ•°æ®åç¦»æ­£æ€åˆ†å¸ƒæ—¶ï¼Œåˆ™Kurtosisè¶‹äºå˜å¤§ã€‚</p>

<pre><code class="language-python">f = []
fft = []

wnd = 127

for i in range(df.shape[0]):
    u,v,w = stft(df[i],fs,nperseg = wnd,noverlap = int(0.8 * wnd),nfft = int(2.0 * wnd)) 
    # stftè¡¨ç¤ºçŸ­æ—¶å‚…é‡Œå¶å˜æ¢,fsè¡¨ç¤ºé‡‡æ ·é¢‘ç‡;npersegè¡¨ç¤ºæ¯æ®µçš„é•¿åº¦,
    # noverlapè¡¨ç¤ºé‡å çš„é•¿åº¦,nfftè¡¨ç¤ºfftçš„é•¿åº¦
    # uè¡¨ç¤ºé¢‘ç‡,vè¡¨ç¤ºæ—¶åŸŸ,wè¡¨ç¤ºé¢‘è°±
    f.append(u)
    fft.append(kurtosis(np.abs(w),fisher = False,axis = 1)) # å¯¹é¢‘è°±å–ç»å¯¹å€¼,ç„¶åè®¡ç®—å³°åº¦
    # fisherè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨Fisheræ ‡å‡†åŒ–,axis = 1è¡¨ç¤ºæ²¿ç€ç¬¬äºŒç»´åº¦è®¡ç®—å³°åº¦

f = np.asarray(f) # asarrayè¡¨ç¤ºå°†è¾“å…¥è½¬æ¢ä¸ºæ•°ç»„,fè¡¨ç¤ºé¢‘ç‡
fft = np.asarray(fft)

fftn = (fft - fft.min()) / (fft.max() - fft.min()) # å½’ä¸€åŒ–,nè¡¨ç¤ºå½’ä¸€åŒ–åçš„é¢‘è°±

fftn = np.asarray(fftn)
n = np.ones_like(f[0])# ones_likeè¡¨ç¤ºè¿”å›ä¸è¾“å…¥å½¢çŠ¶ç›¸åŒçš„æ•°ç»„,æ•°ç»„å…ƒç´ ä¸º1
fig = plt.figure(figsize = (10.0,10.0))
ax = plt.axes(projection = '3d')
ax.view_init(30,225)
for i in range(f.shape[0]):
    ax.plot(f[i] / 1.0e3,i * n,fftn[i],color = 'black',linewidth = 0.50) #  / 1.0e3è¡¨ç¤ºå°†é¢‘ç‡è½¬æ¢ä¸ºkHz

ax.set_xlabel('Frequency (kHz)')
ax.set_ylabel('Sample')
ax.set_zlabel('Kurtosis')
plt.show()
</code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220150240.png" alt="é¢‘è°±å³°åº¦å›¾" /></p>

<h2 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h2>

<h3 id="å‡†å¤‡æ¨¡å‹">å‡†å¤‡æ¨¡å‹</h3>
<p>Kurtosisè¢«ç”¨ä½œ1D-CNNçš„è¾“å…¥(å˜é‡x)ï¼Œè€Œä¸ä¸¤ä¸ªRULç­‰çº§ç›¸å…³çš„æ ‡ç­¾åˆ™é€šè¿‡å˜é‡yâ€“ä¸­å¯¿å‘½æœŸæœ›å€¼ç±»ï¼ˆy = 0ï¼‰ç”¨äºå‰35ä¸ªæ ·æœ¬ï¼Œè€ŒçŸ­å¯¿å‘½é¢„æœŸç±»ï¼ˆy = 1ï¼‰ç”¨äºæœ€å15ä¸ªæ ·æœ¬ã€‚
yè¢«è½¬æ¢ä¸ºåˆ†ç±»æ ¼å¼ï¼Œä»¥é€‚åº”ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ ¼å¼ã€‚</p>

<p>1D-CNNæ˜¯é€šè¿‡ä½¿ç”¨Keraså¼€æºåº“çš„Sequential()å‡½æ•°å®šä¹‰çš„ã€‚</p>

<pre><code class="language-python">X = fftn 
X = X.reshape(-1,f.shape[1],1) # reshapeè¡¨ç¤ºæ”¹å˜æ•°ç»„çš„å½¢çŠ¶,-1è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—,1è¡¨ç¤ºä¸€ç»´ï¼Œf.shape[1]è¡¨ç¤ºé¢‘ç‡çš„é•¿åº¦
y = np.zeros(X.shape[0],dtype = int)
y[-15:] = 1 # yè¡¨ç¤ºæ ‡ç­¾ï¼Œ-15è¡¨ç¤ºä»åå¾€å‰æ•°ç¬¬15ä¸ªï¼Œéƒ½æ˜¯short-life expectancy class (y = 1)

print('Input shape: {:d} samples x {:d} registers/sample'.format(X.shape[0],X.shape[1]))

label = to_categorical(y) # to_categoricalè¡¨ç¤ºå°†æ ‡ç­¾è½¬æ¢ä¸ºone-hotç¼–ç ,one-hotç¼–ç è¡¨ç¤ºå°†æ ‡ç­¾è½¬æ¢ä¸ºäºŒè¿›åˆ¶å‘é‡
label
</code></pre>

<pre><code class="language-console">Input shape: 50 samples x 128 registers/sample
</code></pre>

<pre><code class="language-python">mdl = Sequential() # Sequentialè¡¨ç¤ºé¡ºåºæ¨¡å‹
mdl.add(Conv1D(100,6,activation = 'relu',\
               input_shape = (f.shape[1],1))) # Conv1Dè¡¨ç¤ºä¸€ç»´å·ç§¯å±‚,100è¡¨ç¤ºå·ç§¯æ ¸çš„ä¸ªæ•°,6è¡¨ç¤ºå·ç§¯æ ¸çš„å¤§å°,activationè¡¨ç¤ºæ¿€æ´»å‡½æ•°
mdl.add(Conv1D(100,6,activation = 'relu'))
mdl.add(MaxPooling1D(3))
mdl.add(Conv1D(160,6,activation = 'relu'))
mdl.add(Conv1D(160,6,activation = 'relu'))
mdl.add(GlobalAveragePooling1D())
mdl.add(Dropout(0.5))
mdl.add(Dense(2,activation = 'softmax'))

print(mdl.summary())
</code></pre>

<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220150743.png" alt="æ¨¡å‹æ€»ç»“" /></p>

<h3 id="è®­ç»ƒæ¨¡å‹">è®­ç»ƒæ¨¡å‹</h3>

<pre><code class="language-python">mdl.compile(loss = 'categorical_crossentropy',\
            optimizer = 'adam',metrics = ['accuracy']) # compileè¡¨ç¤ºç¼–è¯‘æ¨¡å‹,lossè¡¨ç¤ºæŸå¤±å‡½æ•°,optimizerè¡¨ç¤ºä¼˜åŒ–å™¨,metricsè¡¨ç¤ºè¯„ä¼°æ¨¡å‹çš„æŒ‡æ ‡
</code></pre>

<p>è¯¥æ¨¡å‹åœ¨50%çš„æ ·æœ¬ä¸Šè¿›è¡Œäº†è®­ç»ƒâ€“éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ•°æ®é›†éå¸¸æœ‰é™ï¼Œåªæœ‰50ä¸ªæ ·æœ¬,å°½ç®¡æ¯ä¸ªæ ·æœ¬æœ‰å¤§é‡çš„è®°å½•ã€‚</p>

<p>è®­ç»ƒæ˜¯åŸºäº1,000ä¸ªepochsâ€“è¿™æ˜¯ä¸ºäº†è®©æ¨¡å‹æœ‰ä¸€ä¸ªè‰¯å¥½çš„æ”¶æ•›ã€‚</p>

<p>ä»£ä»·çŸ©é˜µï¼ˆå˜é‡cwï¼‰è¢«ç”¨æ¥å½±å“åˆ†ç±»ç»“æœå¹¶é¿å…ä¸é”™è¯¯åˆ†ç±»ç›¸å…³çš„é”™è¯¯ã€‚</p>

<p>å½“é‡åˆ°å¾ˆéš¾å†³ç­–çš„æ—¶å€™ï¼Œ<strong>å°†ä¸­ç­‰å¯¿å‘½çš„è½´æ‰¿å½’ç±»ä¸ºçŸ­å¯¿å‘½è½´æ‰¿</strong>ï¼Œå¹¶å°†å†³å®šæƒäº¤ç»™ç»´ä¿®ä¸“å®¶ï¼Œè®©ç»´ä¿®ä¸“å®¶æ¥å†³å®šï¼Œè€Œä¸æ˜¯é”™è¯¯åœ°å°†çŸ­å¯¿å‘½çš„è½´æ‰¿é”™è¯¯åˆ†ç±»å¹¶å¯¼è‡´æœºç»„æ•…éšœã€‚</p>

<pre><code class="language-python">batch,epoch = 32,1000 # batchè¡¨ç¤ºæ¯æ¬¡è®­ç»ƒçš„æ ·æœ¬æ•°,epochè¡¨ç¤ºè®­ç»ƒçš„è½®æ•°
cw = {0: 5.0,1:75.0} # cwè¡¨ç¤ºç±»åˆ«æƒé‡

Xtrain,Xtest,ytrain,ytest = train_test_split(X,label,\
                                             random_state = 21,\
                                             test_size = 0.50)
# train_test_splitè¡¨ç¤ºå°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†,random_stateè¡¨ç¤ºéšæœºæ•°ç§å­,test_sizeè¡¨ç¤ºæµ‹è¯•é›†çš„æ¯”ä¾‹ä¸º50%

hist = mdl.fit(Xtrain,ytrain,batch_size = batch,\
               epochs = epoch,validation_split = 0.2,verbose = 0,\
               class_weight = cw)
# fitè¡¨ç¤ºè®­ç»ƒæ¨¡å‹,batch_sizeè¡¨ç¤ºæ¯æ¬¡è®­ç»ƒçš„æ ·æœ¬æ•°,epochsè¡¨ç¤ºè®­ç»ƒçš„è½®æ•°,validation_splitè¡¨ç¤ºéªŒè¯é›†çš„æ¯”ä¾‹,verboseè¡¨ç¤ºæ—¥å¿—æ˜¾ç¤º,0è¡¨ç¤ºä¸æ˜¾ç¤º
</code></pre>

<p>è®­ç»ƒä¹‹åï¼Œç”»å‡ºaccracyå’Œlosséšç€è®­ç»ƒæ¬¡æ•°çš„å˜åŒ–å›¾ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œæ¥è¿‘1çš„æ­£ç¡®ç‡è¯´æ˜è®­ç»ƒæ”¶æ•›æƒ…å†µè‰¯å¥½ã€‚</p>

<pre><code class="language-python">plt.subplots(1,2,figsize = (9.0,4.5),sharex = True) # sharexè¡¨ç¤ºå…±äº«xè½´
plt.subplot(1,2,1)
plt.plot(hist.epoch,hist.history['accuracy'],\
         color = 'black',lw = 2.50)  
# hist.epochè¡¨ç¤ºè®­ç»ƒçš„è½®æ•°,hist.history['accuracy']è¡¨ç¤ºè®­ç»ƒé›†çš„å‡†ç¡®ç‡,å¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒçš„è½®æ•°å¢åŠ ,è®­ç»ƒé›†çš„å‡†ç¡®ç‡ä¹Ÿåœ¨å¢åŠ 
plt.ylabel('1D-CNN Accuracy')
plt.xlabel('Epoch')
plt.subplot(1,2,2)
plt.plot(hist.epoch,hist.history['loss'],\
         color = 'pink',lw = 2.50)
plt.ylabel('1D-CNN Loss')
plt.xlabel('Epoch')
plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/ChanJeunlam/PicgoBed/blogs/pictures/20230220151615.png" alt="accuracy and loss" /></p>
:ET